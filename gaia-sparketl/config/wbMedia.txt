{"type":"struct","fields":[{"name":"itags","type":{"type":"array","elementType":"string","containsNull":true},"nullable":true,"metadata":{}},{"name":"_id","type":"string","nullable":true,"metadata":{}},{"name":"addTime","type":"long","nullable":true,"metadata":{}},{"name":"authInfo","type":"string","nullable":true,"metadata":{}},{"name":"avgCommentNumInPeroid","type":"long","nullable":true,"metadata":{}},{"name":"avgCommentRateInPeroid","type":"double","nullable":true,"metadata":{}},{"name":"avgCommentRateRankInPeroid","type":"long","nullable":true,"metadata":{}},{"name":"avgForwardNumInPeroid","type":"long","nullable":true,"metadata":{}},{"name":"avgForwardRateInPeroid","type":"double","nullable":true,"metadata":{}},{"name":"avgForwardRateRankInPeroid","type":"long","nullable":true,"metadata":{}},{"name":"avgLikeNumInPeroid","type":"long","nullable":true,"metadata":{}},{"name":"avgLikeRateInPeroid","type":"double","nullable":true,"metadata":{}},{"name":"avgLikeRateRankInPeroid","type":"long","nullable":true,"metadata":{}},{"name":"brief","type":"string","nullable":true,"metadata":{}},{"name":"fansNum","type":"long","nullable":true,"metadata":{}},{"name":"gender","type":"long","nullable":true,"metadata":{}},{"name":"headImage","type":"string","nullable":true,"metadata":{}},{"name":"isAuth","type":"long","nullable":true,"metadata":{}},{"name":"latestArticle","type":{"type":"struct","fields":[{"name":"time","type":"string","nullable":true,"metadata":{}},{"name":"value","type":"string","nullable":true,"metadata":{}}]},"nullable":true,"metadata":{}},{"name":"location","type":"string","nullable":true,"metadata":{}},{"name":"mediaHotWords","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"score","type":"string","nullable":true,"metadata":{}},{"name":"token","type":"string","nullable":true,"metadata":{}}]},"containsNull":true},"nullable":true,"metadata":{}},{"name":"mediaName","type":"string","nullable":true,"metadata":{}},{"name":"pmid","type":"string","nullable":true,"metadata":{}},{"name":"postNum","type":"long","nullable":true,"metadata":{}},{"name":"pubNumInPeroid","type":"long","nullable":true,"metadata":{}},{"name":"pubOriginalArticleNumInPeroid","type":"long","nullable":true,"metadata":{}},{"name":"regiterTime","type":"long","nullable":true,"metadata":{}},{"name":"totalCommentPoints","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"time","type":"long","nullable":true,"metadata":{}},{"name":"value","type":"long","nullable":true,"metadata":{}}]},"containsNull":true},"nullable":true,"metadata":{}},{"name":"totalForwardPoints","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"time","type":"long","nullable":true,"metadata":{}},{"name":"value","type":"long","nullable":true,"metadata":{}}]},"containsNull":true},"nullable":true,"metadata":{}},{"name":"totalLikePoints","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"time","type":"long","nullable":true,"metadata":{}},{"name":"value","type":"long","nullable":true,"metadata":{}}]},"containsNull":true},"nullable":true,"metadata":{}},{"name":"updateTime","type":"long","nullable":true,"metadata":{}}]}
itags,fansNum,postNum,updateTime,addTime,authInfo,brief,gender,headImage,isAuth,location,mediaName,pmid,regiterTime,pubNumInPeroid,avgCommentNumInPeroid,avgForwardNumInPeroid,avgLikeNumInPeroid,totalCommentPoints,totalForwardPoints,totalLikePoints,pubOriginalArticleNumInPeroid,avgCommentRateInPeroid,avgForwardRateInPeroid,avgLikeRateInPeroid,avgCommentRateRankInPeroid,avgForwardRateRankInPeroid,avgLikeRateRankInPeroid,latestArticle,mediaHotWords
mediaTempTable
insert overwrite table gaia.wbmedia partition(time_date)  select itags,fansNum,postNum,updateTime,addTime,authInfo,brief,gender,headImage,isAuth,location,mediaName,pmid,regiterTime,pubNumInPeroid,avgCommentNumInPeroid,avgForwardNumInPeroid,avgLikeNumInPeroid,totalCommentPoints,totalForwardPoints,totalLikePoints,pubOriginalArticleNumInPeroid,avgCommentRateInPeroid,avgForwardRateInPeroid,avgLikeRateInPeroid,avgCommentRateRankInPeroid,avgForwardRateRankInPeroid,avgLikeRateRankInPeroid,latestArticle,mediaHotWords,from_unixtime(substring(updateTime,0,10),'yyyyMMddHH') as time_date from mediaTempTable where mediaName is not null and pmid is not null
{"host":"192.168.5.31:27017","database":"test","collection":"wbMedia","splitSize":"100","cursorBatchSize":"200","splitKeyType":"long","splitKey":"updateTime"}