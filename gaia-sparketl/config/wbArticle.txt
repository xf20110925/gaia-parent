{"type":"struct","fields":[{"name":"_id","type":"string","nullable":true,"metadata":{}},{"name":"addTime","type":"long","nullable":true,"metadata":{}},{"name":"aritcleType","type":"string","nullable":true,"metadata":{}},{"name":"articleUrl","type":"string","nullable":true,"metadata":{}},{"name":"commentNum","type":"long","nullable":true,"metadata":{}},{"name":"content","type":"string","nullable":true,"metadata":{}},{"name":"coverPlan","type":"string","nullable":true,"metadata":{}},{"name":"forwardNum","type":"long","nullable":true,"metadata":{}},{"name":"isOriginal","type":"long","nullable":true,"metadata":{}},{"name":"likeNum","type":"long","nullable":true,"metadata":{}},{"name":"pmid","type":"string","nullable":true,"metadata":{}},{"name":"postTime","type":"long","nullable":true,"metadata":{}},{"name":"source","type":"string","nullable":true,"metadata":{}},{"name":"title","type":"string","nullable":true,"metadata":{}},{"name":"hotToken","type":{"type":"array","elementType":{"type":"struct","fields":[{"name":"score","type":"string","nullable":true,"metadata":{}},{"name":"token","type":"string","nullable":true,"metadata":{}}]},"containsNull":true},"nullable":true,"metadata":{}},{"name":"updateTime","type":"long","nullable":true,"metadata":{}}]}
pmid,articleUrl,commentNum,forwardNum,likeNum,isOriginal,postTime,updateTime,hotToken
hiveTempTable
insert overwrite table gaia.wbArticle partition(time_date) select pmid,articleUrl,commentNum,forwardNum,likeNum,isOriginal,postTime,updateTime,hotToken,from_unixtime(substring(updateTime,0,10),'yyyyMMddHH') time_date from hiveTempTable where commentNum is not null
{"host":"192.168.5.31:27017","splitKeyType":"long","splitKey":"updateTime","database":"mongodb_database_name","collection":"wbArticle","splitSize":"wb_split_size_count","cursorBatchSize":"wb_cursor_batch_size_count"}